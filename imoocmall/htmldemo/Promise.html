<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>promise</title>
</head>
<body>

</body>
<script>
  let checkLogin = function() {
    return new Promise(function(resolve,reject){
      let flag = document.cookie.indexOf("userId")==-1? true:false;
      if(flag) {
        resolve({
          kevin:0,
          result:true
        })
      }else{reject("somethin is wrong")}
    })
  };
  let getUserInfo = ()=>{
    return new Promise((resolve,reject)=>{
      //模拟接口调用
      let userInfo = {userId:"101", age: 11}
      resolve(userInfo)
    })
  }
  //Promise 第一种示例： 链式调用
  checkLogin().then( res=> {
    if(res.kevin == 0) {
      console.log("user login fine")
      //返回用户所有信息
      return getUserInfo();
    }
  }).catch((err)=>{
    console.log(`error: ${err}`)
  }).then(userInfo=>{
    //打印出用户某条信息
    console.log(`age: ${userInfo.age}`)
  })
  //Promise 第二种示例： 并发调用
  Promise.all([checkLogin(),getUserInfo()]).then(([res1,res2])=>{
    console.log(`result1结果; ${res1.result};  result2: ${res2.age}`)  //result1结果; true;  result2: 11
  })
</script>
</html>
